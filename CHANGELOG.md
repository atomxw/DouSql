# 更新日志

## [3.0.7] - 2026-01-15
### 更新
- **代码太重，采用Extender Api实现方式重构项目**
- **新增请求超时配置**：时间阀值配置模块中进行配置
- **新增右键暂停请求**：会停止所有请求，需要重新加载插件才可使用
- **优化并添加多个payloadad组**：移除重复payload，添加多个默认payload测试组
### 修复
- **数组嵌套json的特殊请求无法被识别的错误**
- **黑名单URL误过滤的错误**：细化处理，不匹配hostname
- **修复render无法渲染的错误**


## [3.0.6] - 2026-01-06
### 新增功能
- **支持右键停止当前目标请求测试**：当出现异常/不想对某些目标发起请求，可以右键停止。
- **支持右键删除测试请求**：当某些测试结果无效，用户想在界面中剔除掉。

## [3.0.5] - 2026-01-04

### 修复
- **修复中文参数编码问题**：修复了默认payload测试时仍使用原始值而非修正值的关键bug，确保中文参数在所有测试场景下都能正确处理
- **完全采用test.txt的中文编码修复方法**：移除复杂的检测逻辑，直接使用ISO_8859_1→UTF_8的无条件转换，与成功案例保持一致
- **修复UI显示层中文乱码问题**：修正LogEntry中保存的参数值，确保结果界面显示完整的测试值（包含修复后的中文字符）而非仅显示payload
- **修复实际请求发送层中文乱码问题**：避免对修复后的中文字符进行额外的URL编码，确保实际发送的HTTP请求包含正确的中文字符
- **完全对齐test.txt的LogEntry保存逻辑**：在LogEntry中直接保存`workingValue + payload`，避免在请求处理过程中对中文字符的二次编码损坏
- **增强JSON参数中文字符处理**：添加详细的JSON处理调试信息，并提供字符串替换备选方案，确保JSON参数中的中文字符在实际HTTP请求中正确显示

### 技术实现详情
- **新增EncodingUtils工具类**：专门处理中文编码问题，实现ISO_8859_1→UTF_8转换逻辑
- **增强HttpUtils编码修复**：实现真正的`fixEncodingIssues`方法，支持参数级别的编码修复
- **优化LogEntry数据保存**：保存修复后的完整工作值（workingValue），确保UI显示正确的中文字符
- **添加编码调试功能**：提供详细的参数编码调试信息，包括原始值、解码值、字节数组等
- **支持多编码格式检测**：自动检测UTF-8、GBK、GB2312、ISO-8859-1等编码格式
- **JSON参数特殊处理**：针对JSON格式参数提供专门的中文字符编码修复逻辑

## [3.0.4] - 2025-12-30

### 新增功能
- **自定义延时发包**：支持无延时、固定延时、随机延时三种模式，可配置延时时间和随机区间
- **多参数追加功能**：支持同时追加多个参数，使用key:value格式，一行一个参数，自动识别请求格式
- **智能参数排除**：追加的参数可选择是否参与payload测试，提供更灵活的控制
- **参数测试模式**：用户可自定义追加参数的测试行为，既可避免重复也可发现更多漏洞
- **右键菜单payload组选择**：右键菜单支持选择特定payload组进行测试，提供更灵活的测试策略

### 优化改进
- **分离payload保存加载功能**：添加独立的"保存payload"按钮，功能职责更清晰
- **增强JSON参数追加**：改进JSON格式检测逻辑，确保参数正确添加到JSON请求体
- **完善调试日志**：添加详细的追加参数处理日志，便于问题排查
- **优化追加参数UI**：左右分割界面，左侧配置参数，右侧独立控制每个参数的测试开关
- **右键菜单体验优化**：将原单一菜单项改为子菜单结构，支持当前组快速测试和指定组精确测试

### 修复
- **修复JSON追加参数检测问题**：改进Content-Type检测逻辑，使用双重检测机制（枚举值+HTTP头）确保JSON参数正确添加到请求体
- **修复payload保存逻辑混乱**：分离保存和加载功能，添加独立的"保存payload"按钮，避免用户操作困惑
- **优化追加参数格式识别**：增强对application/json格式的识别准确性，提供详细的调试日志便于问题排查
- **修复参数过滤配置持久化问题**：黑名单和白名单参数分别独立存储，切换模式时不会丢失之前配置的参数
- **修复响应render无法加载问题**：大幅改进响应查看器实现，解决uiComponent()返回null和线程问题导致的渲染失败
- **增强响应显示稳定性**：实现多重响应设置策略，添加Raw标签备用显示，确保响应内容始终可见
- **优化响应查看器错误处理**：添加完整的异常处理和状态提示，提供详细的调试日志便于问题排查
- **修复右键菜单payload组切换问题**：解决选择指定payload组时仍使用default组payload的问题，确保payload组正确切换
- **修复响应查看器UI重复问题**：移除额外的Render/Raw标签页，直接使用Burp Suite原生的响应查看器，避免双层标签结构
- **修复中文参数乱码问题**：改进参数编码处理逻辑，支持中文参数的正确编码和解码，解决重访时中文参数乱码的问题
- **增强参数编码调试**：添加详细的参数编码调试信息，包括原始值、解码值、字节数组等，便于排查编码问题
- **修复Montoya API编码缺陷**：绕过Montoya API的参数解析问题，直接从原始请求字节流中提取参数值，确保中文字符不被损坏
- **多编码支持**：支持UTF-8、GBK、GB2312等多种编码格式，自动检测和选择最佳编码方式处理中文参数
- **修复右键菜单编码传递问题**：在右键菜单数据传递环节添加编码修复逻辑，确保中文参数在传递给插件时不会乱码
- **修复参数fuzz时中文乱码问题**：改进参数更新逻辑，添加安全的参数更新方法和手动请求构造，确保中文+payload拼接后不会乱码

## [3.0.3] - 2025-12-28

### 优化改进
- **重构JSON参数处理**：使用Burp Suite内置JsonUtils和JsonNode API替代复杂的自定义解析算法
- **提升JSON处理准确性**：利用官方API的稳定性和可靠性，减少解析错误
- **简化代码结构**：移除冗余的JSON解析方法，提高代码可维护性
- **增强嵌套结构支持**：更好地处理复杂的JSON参数场景，提升开源用户体验
- **优化工具监听逻辑**：默认只监听Proxy和Repeater流量，不自动处理Scanner和Intruder流量

### 新增功能
- **自定义延时发包**：支持无延时、固定延时、随机延时三种模式，可配置延时时间和随机区间
- **自定义追加参数**：支持为每个请求自动追加指定的key/value参数，兼容各种请求格式
- **智能参数排除**：追加的参数可选择是否参与payload测试，提供更灵活的控制
- **参数测试模式**：用户可自定义追加参数的测试行为，既可避免重复也可发现更多漏洞

### 修复
- **修复Windows系统UI显示问题**：优化payload组管理按钮布局，确保所有按钮完整显示
- **修复白名单按钮显示问题**：改进GridBagLayout约束，解决按钮被隐藏的问题
- **修复白名单输入框隐藏问题**：重新设计控制面板布局，确保输入框正确显示
- **修复布局结构错误**：恢复正确的三层分割面板结构，确保所有UI组件正常显示
- **修复右侧面板丢失问题**：纠正分割面板配置，恢复控制面板和标签页的正确布局
- **修复请求响应查看器丢失**：恢复左侧下方的数据包详情显示区域
- **修复Scanner流量自动处理问题**：移除Scanner和Intruder流量的自动处理，只处理用户明确启用的工具
- **修复payload保存逻辑混乱**：分离保存和加载功能，添加独立的"保存payload"按钮
- **修复JSON追加参数失效问题**：改用JsonNode API处理JSON参数追加，确保参数正确添加到JSON body
- **优化Windows DPI适配**：添加DPI感知和字体渲染优化，提升高分辨率显示效果
- **改进UI组件布局**：使用更稳定的布局管理器，确保跨平台兼容性

## [3.0.2] - 2025-12-28

### 新增
- 优化配置文件路径，配置文件现在存储在用户主目录的`dousql/`目录下
- **增强JSON处理能力**：支持复杂嵌套JSON结构，包括多层对象、数组和混合数据类型
- 扩展默认payload字典，新增多种SQL注入检测payload（共17种）
- 扩展默认报错信息字典，支持多种数据库和框架的错误信息识别（共33种）
- 完善使用文档，新增结果标记说明和使用技巧指南

### 修复
- 修复配置文件路径检测问题，避免在Burp临时目录下创建无效路径
- 改进路径验证逻辑，确保配置目录始终有效且可访问
- **修复状态显示问题**：解决测试异常时状态一直显示"start"的问题

### 改进
- 简化配置文件管理，统一使用`~/dousql/`目录，提高用户体验
- **大幅提升JSON处理能力**：重写JSON解析逻辑，支持任意深度的嵌套结构和复杂数据类型
- 增强payload覆盖范围，支持更多注入场景
- 扩展静态文件过滤列表，包含更多图片格式和静态资源类型
- 完善文档说明，提供详细的配置目录说明和JSON处理指南

## [3.0.1] - 2025-12-26

### 修复
- 修复工具来源判断逻辑错误导致的无限循环测试问题
- 修复响应时间检测优先级问题，确保超时请求正确显示"time > N"标记
- 优化监听条件判断，避免未启用监听时错误处理toolFlag=0的请求

### 改进
- 提升插件稳定性和可靠性
- 优化检测结果显示逻辑

## [3.0.0] - 2025-12-25

### 新增
- 基于Montoya API重构，提升稳定性和兼容性
- 新增payload分组管理功能，支持多种测试场景
- 优化用户界面布局，改进左右分割面板设计
- 新增参数过滤系统，支持白名单/黑名单模式
- 新增黑名单URL过滤功能，支持通配符匹配
- 新增自定义报错信息检测功能
- 新增响应时间阈值和长度差异阈值配置
- 优化时间盲注检测逻辑，支持全payload类型时间检测
- 新增配置文件统一管理，所有配置持久化保存
- 新增HTTP方法过滤，仅检测GET/POST请求
- 优化错误检测优先级，报错信息优先于其他变化标记
- 新增状态栏时间超时标记，完善检测结果展示

### 修复
- 修复跨平台兼容性问题，确保Windows/macOS下界面正常显示
- 修复多线程并发问题，提升插件稳定性

### 改进
- 全面重构代码架构，提升维护性
- 优化用户界面设计，提升用户体验
- 完善配置管理系统，提高易用性